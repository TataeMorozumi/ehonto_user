{% extends "base.html" %}
{% load custom_filters %}

{% block title %}ãµã‚Šã‹ãˆã‚Š{% endblock %}

{% block content %}
<!-- ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
<div class="calendar-nav">
  <a href="?month={{ prev_month.month }}&year={{ prev_month.year }}">â—€ å‰ã®æœˆ</a>
  <span class="current-month">{{ current_date|date:"Yå¹´næœˆ" }}</span>
  <a href="?month={{ next_month.month }}&year={{ next_month.year }}">æ¬¡ã®æœˆ â–¶</a>
</div>

<!-- ğŸ§’ å­ã©ã‚‚é¸æŠãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ -->
<div class="child-selector">
  <form method="get" action="{% url 'review' %}" id="childSelectForm">
    <label for="child">æœ¬æ£šã‚’é¸æŠ:</label>
    <select name="child_id" id="child" onchange="document.getElementById('childSelectForm').submit()">
      <option value="" {% if not selected_child_id %}selected{% endif %}>å…±é€šã®æœ¬æ£š</option>
      {% for child in children %}
        <option value="{{ child.id }}" {% if selected_child_id == child.id|stringformat:"s" %}selected{% endif %}>
          {{ child.name }}
        </option>
      {% endfor %}
    </select>
  </form>
</div>

{% if most_read_title %}
  <div class="most-read-banner">
    ğŸ“š ä»Šæœˆã‚‚ã£ã¨ã‚‚èª­ã¾ã‚ŒãŸçµµæœ¬ï¼š<strong>{{ most_read_title }}</strong>
  </div>
{% endif %}

<!-- ğŸ”¼ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®ä¸Šéƒ¨ãªã©ã«è¿½åŠ  -->
<div class="monthly-summary">
    <p>ğŸ“š ä»Šæœˆã®èª­ã¿èã‹ã›åˆè¨ˆï¼š{{ monthly_total }} å›</p>
    <ul>
      {% for child, total in child_totals.items %}
        <li>{{ child }}ï¼š{{ total }} å›</li>
      {% endfor %}
    </ul>
  </div>
  


<!-- ğŸ“š ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æœ¬ä½“ -->
<div class="calendar-grid">
    {% for weekday in "æ—¥æœˆç«æ°´æœ¨é‡‘åœŸ"|make_list %}
      <div class="calendar-weekday">{{ weekday }}</div>
    {% endfor %}
  
    {% for day in calendar_days %}
      <div class="calendar-cell">
        <div class="calendar-day">{{ day }}</div>
  
        {% with calendar_data|get_item:day as books %}
          {% if books %}
            {% for book in books %}
              <div class="book-icon" title="{{ book.title }}">
                <a href="{% url 'book_detail' book.id %}">
                  <img src="{{ book.image.url }}" alt="{{ book.title }}">
                </a>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}
      </div>
    {% endfor %}
  </div>
  
{% endblock %}

